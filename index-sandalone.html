<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Primary Meta Tags -->
    <title>
      Magic Mikes (Local Mode) - MTG Tournament Manager | Offline Swiss &
      Elimination Brackets
    </title>
    <meta
      name="title"
      content="Magic Mikes (Local Mode) - MTG Tournament Manager | Offline Swiss & Elimination Brackets"
    />
    <meta
      name="description"
      content="Offline Magic: The Gathering tournament management tool. Create and manage Swiss, Round Robin, Elimination, and Group Stage tournaments locally in your browser with no internet required."
    />
    <meta
      name="keywords"
      content="Magic The Gathering, MTG tournament, tournament manager, Swiss pairing, elimination bracket, offline tournament, MTG organizer, tournament software, magic tournament, TCG tournament, card game tournament, local storage tournament"
    />
    <meta name="author" content="Magic Mikes Tournament" />
    <meta name="theme-color" content="#8b5cf6" />
    <link rel="canonical" href="https://andreytodorov.github.io/magic/local" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://andreytodorov.github.io/magic/local"
    />
    <meta
      property="og:title"
      content="Magic Mikes (Local Mode) - MTG Tournament Manager"
    />
    <meta
      property="og:description"
      content="Offline Magic: The Gathering tournament management tool. Create and manage tournaments locally in your browser with no internet required."
    />
    <meta
      property="og:image"
      content="https://andreytodorov.github.io/magic/og-image.jpg"
    />
    <meta property="og:site_name" content="Magic Mikes" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta
      property="twitter:url"
      content="https://andreytodorov.github.io/magic/local"
    />
    <meta
      property="twitter:title"
      content="Magic Mikes (Local Mode) - MTG Tournament Manager"
    />
    <meta
      property="twitter:description"
      content="Offline Magic: The Gathering tournament management tool with local storage support."
    />
    <meta
      property="twitter:image"
      content="https://andreytodorov.github.io/magic/twitter-card.jpg"
    />

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />

    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Magic Mikes Tournament Manager (Local Mode)",
        "description": "Offline Magic: The Gathering tournament management tool with local storage support for Swiss, Round Robin, Elimination, and Group Stage formats.",
        "url": "https://andreytodorov.github.io/magic/local",
        "applicationCategory": "UtilitiesApplication",
        "operatingSystem": "Web Browser",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "USD"
        },
        "featureList": [
          "Swiss Tournament Pairing",
          "Elimination Brackets",
          "Round Robin Tournaments",
          "Group Stage Playoffs",
          "Offline Support",
          "Local Storage",
          "Live Standings",
          "Automated Match Generation",
          "Best of 3 Scoring"
        ],
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "potentialAction": {
          "@type": "UseAction",
          "target": "https://andreytodorov.github.io/magic/local"
        }
      }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@600;700;800;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/styles.css" />
  </head>
  <body>
    <!-- Connection Status -->
    <div class="connection-status" id="connectionStatus">
      <div class="status-dot"></div>
      <span id="statusText">Local Mode</span>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-to-top" id="scrollToTop" aria-label="Scroll to top">
      ‚Üë
    </button>

    <!-- Main Container -->
    <div class="container" id="main-content">
      <!-- Header -->
      <header class="app-header">
        <h1 class="app-title">Magic Mikes</h1>
        <div
          style="
            background: #fff3cd;
            padding: 8px;
            border-radius: 6px;
            font-size: 0.85em;
            margin-top: 10px;
          "
        >
          <strong>Local Mode:</strong> All data stored in your browser (no
          internet required)
        </div>
      </header>

      <!-- Mode Selection -->
      <nav class="mode-selector" id="modeSelector">
        <button
          class="mode-btn"
          data-mode="create"
          aria-label="Create new tournament"
        >
          Create Tournament
        </button>
        <button
          class="mode-btn"
          data-mode="join"
          aria-label="Join existing tournament"
        >
          Join Tournament
        </button>
      </nav>

      <!-- Join Tournament Section -->
      <section
        class="section section--padded"
        id="joinSection"
        aria-labelledby="joinTitle"
      >
        <form id="joinForm">
          <div class="form-group">
            <label for="tournamentCode" class="form-label" id="joinTitle">
              Enter Tournament Code:
            </label>
            <input
              type="text"
              id="tournamentCode"
              class="form-input form-input--center"
              placeholder="e.g., ABC12345"
              maxlength="8"
              minlength="8"
              pattern="[A-Z0-9]{8}"
              style="text-transform: uppercase"
              required
              aria-describedby="joinError"
            />
          </div>
          <button type="submit" class="btn" id="joinSubmitBtn">
            Join Tournament
          </button>
          <div id="joinError" role="alert" aria-live="polite"></div>
        </form>
      </section>

      <!-- Format Selection Section -->
      <section
        class="section section--padded"
        id="formatSelectionSection"
        aria-labelledby="formatSelectionTitle"
      >
        <h2 class="section-title" id="formatSelectionTitle">
          Choose Tournament Format
        </h2>
        <div class="format-grid" id="formatGrid">
          <!-- Format cards will be dynamically generated -->
        </div>
        <button class="btn btn--text" id="backToModeBtn">‚Üê Back</button>
      </section>

      <!-- Create Tournament Section -->
      <section
        class="section section--padded"
        id="createSection"
        aria-labelledby="createTitle"
      >
        <div class="format-header">
          <button class="btn btn--text btn--small" id="backToFormatBtn">
            ‚Üê Change Format
          </button>
          <h3 class="format-title" id="selectedFormatTitle"></h3>
        </div>

        <!-- Player Count Selector -->
        <div class="form-group text-center">
          <label for="playerCount" class="form-label">Number of Players:</label>
          <select
            id="playerCount"
            class="form-select"
            aria-label="Select number of players"
          >
            <option value="3">3 Players</option>
            <option value="4">4 Players</option>
            <option value="5">5 Players</option>
            <option value="6">6 Players</option>
            <option value="7">7 Players</option>
            <option value="8" selected>8 Players</option>
            <option value="9">9 Players</option>
            <option value="10">10 Players</option>
            <option value="11">11 Players</option>
            <option value="12">12 Players</option>
          </select>
        </div>

        <!-- Format-specific configuration container -->
        <div id="formatConfigContainer"></div>

        <!-- Matches Per Player Selector (for Round Robin) -->
        <div class="matches-selector" id="matchesPerPlayerContainer">
          <label for="matchesPerPlayer" class="form-label"
            >Matches Per Player:</label
          >
          <select
            id="matchesPerPlayer"
            class="form-select"
            aria-label="Select matches per player"
          ></select>
        </div>

        <!-- Player Name Inputs -->
        <div class="input-grid" id="playerInputs"></div>

        <button
          class="btn"
          id="generateBtn"
          aria-label="Generate tournament bracket"
        >
          Generate Tournament
        </button>
      </section>

      <!-- Tournament View -->
      <section
        class="section"
        id="tournamentSection"
        aria-labelledby="tournamentTitle"
      >
        <div class="code-display" id="codeDisplay">
          <h3 class="code-display__title">Tournament Code:</h3>
          <div>
            <span class="code-box" id="displayCode"></span>
            <button class="btn btn--success btn--small" id="copyCodeBtn">
              Copy Code
            </button>
          </div>
          <div class="alert alert--warning">
            Save this code to access your tournament later (stored locally in
            browser)
          </div>
        </div>

        <!-- Tournament Header -->
        <div class="header-bar">
          <div class="header-bar__actions">
            <button
              class="btn btn--warning btn--small"
              id="lockTournamentBtn"
              style="display: none"
            >
              <span id="lockBtnText">üîí Lock Tournament</span>
            </button>
            <button class="btn btn--danger btn--small" id="leaveTournamentBtn">
              Leave Tournament
            </button>
          </div>
        </div>

        <div
          class="progress-bar"
          role="progressbar"
          aria-label="Tournament completion"
        >
          <div class="progress-bar__fill" id="progressFill"></div>
          <div class="progress-text" id="progressText" aria-live="polite"></div>
        </div>

        <!-- Locked Indicator -->
        <div
          class="alert alert--warning"
          id="lockedIndicator"
          style="display: none; margin-bottom: var(--spacing-md)"
        >
          üîí <strong>Tournament Locked:</strong> Match results cannot be
          changed. Only the creator can unlock.
        </div>

        <!-- Tournament Info -->
        <div class="tournament-info" id="tournamentInfo" style="display: none">
          <span class="tournament-info__badge" id="formatBadge"></span>
          <span
            class="tournament-info__badge"
            id="stageBadge"
            style="display: none"
          ></span>
        </div>

        <!-- Stage Advancement Button -->
        <div
          class="stage-advancement"
          id="stageAdvancement"
          style="display: none"
        >
          <button class="btn btn--primary" id="advanceStageBtn">
            <span id="advanceStageText">Advance to Next Round</span>
          </button>
        </div>

        <!-- View Tabs: allow quick switching between Schedule / Standings / Matches -->
        <div
          class="view-tabs"
          id="viewTabs"
          role="tablist"
          aria-label="Tournament views"
        >
          <button
            class="tab-btn"
            id="tabSchedule"
            data-view="schedule"
            role="tab"
            aria-pressed="false"
          >
            Player Schedule
          </button>
          <button
            class="tab-btn active"
            id="tabMatches"
            data-view="matches"
            role="tab"
            aria-pressed="true"
          >
            Matches
          </button>
          <button
            class="tab-btn"
            id="tabStandings"
            data-view="standings"
            role="tab"
            aria-pressed="false"
          >
            Live Standings
          </button>
        </div>

        <div class="schedule-info" id="scheduleInfo">
          <h4 class="schedule-info__title">
            Player Schedule - Each player competes in
            <span id="gamesPerPlayer"></span> matches
          </h4>
          <div class="schedule-grid" id="scheduleGrid"></div>
        </div>

        <div class="tournament-layout">
          <aside id="standingsPanel" class="standings-panel">
            <h3 class="standings-panel__title">Live Standings</h3>
            <div
              class="scoring-legend"
              id="scoringLegend"
              tabindex="0"
              role="button"
              aria-expanded="false"
              aria-controls="scoringLegendDetails"
            >
              <div class="scoring-legend__header">
                <strong>Scoring System:</strong>
                <span class="scoring-legend__chev" aria-hidden="true"></span>
              </div>

              <div
                class="scoring-legend__details"
                id="scoringLegendDetails"
                hidden
              >
                <ul>
                  <li>Match Win: +3 pts</li>
                  <li>Game Won: +1 pt</li>
                  <li>Game Lost: -0.5 pts</li>
                </ul>

                <h4>How tiebreaking works</h4>

                <ul>
                  <li>
                    <strong>Primary ‚Äî Total Points:</strong> Players are ranked
                    by total points (match wins √ó 3 + games won √ó 1 + games lost
                    √ó -0.5).
                  </li>
                  <li>
                    <strong>Secondary ‚Äî Head-to-head:</strong> If two players
                    are tied on points and played each other, the winner of
                    their direct match ranks higher.
                  </li>
                  <li>
                    <strong>Tertiary ‚Äî Quality Score:</strong> Sum of the
                    defeated opponents' total points. Beating stronger opponents
                    increases your quality score.
                  </li>
                  <li>
                    <strong>Fourth ‚Äî Win Percentage:</strong> Percentage of
                    matches won (useful when players have played different
                    numbers of matches).
                  </li>
                  <li>
                    <strong>Fifth ‚Äî Game Differential:</strong> Games won ‚àí
                    games lost.
                  </li>
                  <li>
                    <strong>Final ‚Äî Total Games Won:</strong> If still tied, the
                    player with more games won ranks higher.
                  </li>
                </ul>

                <p>
                  Examples and notes: If points are identical but you beat a
                  tied opponent directly, head-to-head decides the order. If
                  head-to-head doesn't apply (no match between the tied players
                  or a circular tie), the quality score (sum of beaten
                  opponents' points) is used next.
                </p>
                <p style="font-size: 0.9em; color: #4b5563; margin-top: 8px">
                  You can change scoring values in <code>js/config.js</code> ‚Äî
                  see the APP_CONFIG.SCORING section.
                </p>
              </div>
            </div>
            <div class="standings-table" id="standingsTable" role="list"></div>
          </aside>

          <!-- Round/Stage Navigation -->
          <div
            class="round-navigation"
            id="roundNavigation"
            style="display: none"
          >
            <div
              class="round-navigation__buttons"
              id="roundNavigationButtons"
            ></div>
          </div>

          <main
            class="matches-container"
            id="matchesContainer"
            role="list"
          ></main>
        </div>
      </section>
    </div>

    <!-- Load scripts in order -->
    <script src="js/logger.js"></script>
    <script src="js/config.js"></script>
    <script src="js/tournament-formats.js"></script>
    <script src="js/localStorage-manager.js"></script>
    <script src="js/tournament.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
